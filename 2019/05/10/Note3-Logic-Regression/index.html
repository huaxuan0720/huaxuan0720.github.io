<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
<title>逻辑回归算法 - Welcome to My Blogs</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta name="description" content="前言   前面主要是讲反向传播和梯度下降的方法，那么其实涉及梯度的机器学习方法并不是只有深度学习一种，逻辑回归也是可以利用梯度的信息进行参数的更新，使得模型逐步满足我们的数据要求。注意，逻辑回归输出的是属于某一种类别的概率，利用阈值的控制来进行判别，因此逻辑回归本质上是一种分类方法。">
<meta name="keywords" content="机器学习,逻辑回归">
<meta property="og:type" content="article">
<meta property="og:title" content="逻辑回归算法">
<meta property="og:url" content="http://huaxuan0720.github.io/2019/05/10/Note3-Logic-Regression/index.html">
<meta property="og:site_name" content="Welcome to My Blogs">
<meta property="og:description" content="前言   前面主要是讲反向传播和梯度下降的方法，那么其实涉及梯度的机器学习方法并不是只有深度学习一种，逻辑回归也是可以利用梯度的信息进行参数的更新，使得模型逐步满足我们的数据要求。注意，逻辑回归输出的是属于某一种类别的概率，利用阈值的控制来进行判别，因此逻辑回归本质上是一种分类方法。">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://huaxuan0720.github.io/gallery/MachineLearning.jpg">
<meta property="og:updated_time" content="2019-06-03T07:34:53.321Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="逻辑回归算法">
<meta name="twitter:description" content="前言   前面主要是讲反向传播和梯度下降的方法，那么其实涉及梯度的机器学习方法并不是只有深度学习一种，逻辑回归也是可以利用梯度的信息进行参数的更新，使得模型逐步满足我们的数据要求。注意，逻辑回归输出的是属于某一种类别的概率，利用阈值的控制来进行判别，因此逻辑回归本质上是一种分类方法。">
<meta name="twitter:image" content="http://huaxuan0720.github.io/gallery/MachineLearning.jpg">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/github-gist.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    

    
    
    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    

    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/favicon.svg" alt="逻辑回归算法" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item" href="/">主页</a>
                
                <a class="navbar-item" href="/archives/">归档</a>
                
                <a class="navbar-item" href="/categories/">类别</a>
                
                <a class="navbar-item" href="/tags/">标签</a>
                
                <a class="navbar-item" href="/about/">关于</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="Xuan Hua&#39;s GitHub" href="https://www.github.com/huaxuan0720">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                <a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;">
                    <i class="fas fa-list-ul"></i>
                </a>
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-9-widescreen has-order-2 column-main"><div class="card">
    
    <div class="card-image">
        <span class="image is-7by1">
            <img class="thumbnail" src="/gallery/MachineLearning.jpg" alt="逻辑回归算法">
        </span>
    </div>
    
    <div class="card-content article ">
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <i class="fas fa-angle-double-right"></i>逻辑回归算法
            
        </h1>
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-05-10T09:20:51.000Z"><i class="far fa-calendar-alt">&nbsp;</i>2019-05-10</time>
                
                <time class="level-item has-text-grey is-hidden-mobile" datetime="2019-06-03T07:34:53.321Z"><i class="far fa-calendar-check">&nbsp;</i>2019-06-03</time>
                
                
                <div class="level-item">
                <i class="far fa-folder-open has-text-grey"></i>&nbsp;
                <a class="has-link-grey -link" href="/categories/机器学习/">机器学习</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    <i class="far fa-clock"></i>&nbsp;
                    
                    
                    22 minutes read (About 3299 words)
                </span>
                
                
                <span class="level-item has-text-grey" id="busuanzi_container_page_pv">
                    <i class="far fa-eye"></i>
                    <span id="busuanzi_value_page_pv">0</span> visits
                </span>
                
            </div>
        </div>
        
        <div class="content">
            <p><strong>前言</strong><br>
  前面主要是讲反向传播和梯度下降的方法，那么其实涉及梯度的机器学习方法并不是只有深度学习一种，逻辑回归也是可以利用梯度的信息进行参数的更新，使得模型逐步满足我们的数据要求。注意，逻辑回归输出的是属于某一种类别的概率，利用阈值的控制来进行判别，因此逻辑回归本质上是一种<strong>分类方法</strong>。 <a id="more"></a></p>
<h5 id="一逻辑斯蒂回归">一、逻辑斯蒂回归</h5>
<p>  逻辑斯蒂回归（logistic regression，下面简称逻辑回归），是一种十分经典的分类方法。我们首先介绍一下逻辑回归的定义。<br>
  假设我们有一个数据集 <span class="math inline">\(S\)</span>，一共包含<span class="math inline">\(m\)</span>个样本数据，即： <span class="math inline">\(S = \{(x_1,y_1),(x_2,y_2),...,(x_m，y_m)\}\)</span>，其中，<span class="math inline">\(y_i \in \{0, 1\}\)</span>。为了表示的方便，我们不妨设当<span class="math inline">\(y_i = 1\)</span>时为正样本，当<span class="math inline">\(y_i = 0\)</span>时为负样本，当然，反过来也是可以的，这个并不重要，只不过一般习惯这样表达。</p>
<p>  在SVM中，我们根据数据集的分布，求解出了一个二分的超平面 <span class="math inline">\(f(x) = \omega \cdot x+b\)</span>，现在我们要对一个新的样本点<span class="math inline">\(x_0\)</span>进行分类预测，需要将这个样本点带入上面的超平面公式。当<span class="math inline">\(f(x_0) = \omega \cdot x_0 + b &gt; 0\)</span>时，我们将这个样本点标记为1，当<span class="math inline">\(f(x_0) = \omega \cdot x_0 + b \leq 0\)</span>时，我们将这个样本点标记为-1。观察到SVM只能对新样本输出 <span class="math inline">\(\pm1\)</span>，无法较为准确的输出样本属于每一个类别的概率究竟是多少。SVM结果的正确性在于它保证了找到的是样本间隔最大的那个超平面，这样就可以保证以最高的精确度区分新的样本。然而SVM却无法对一个新样本的概率进行求解。而这就是逻辑回归主要做的事情，它输出的是一个概率值，当这个概率值大于一定的阈值时，样本标记为1，反之则标记为0。</p>
<h5 id="二sigmoid函数">二、sigmoid函数</h5>
<p>  熟悉深度学习的人肯定对这个函数非常了解，它是早期深度学习网络经常使用的激活函数之一。它的定义公式如下： <span class="math display">\[
sigmoid(x) = \frac{1}{1 + e^{-x}} \quad x \in R
\]</span>   它的函数图像是一个典型的S型曲线，定义域是全体实数。我们根据公式可以发现，这个函数将全体实数映射到了 <span class="math inline">\((0, 1)\)</span> 区间上，并在这个区间上单调递增，<span class="math inline">\(x\)</span>越大，函数值越大。而这正好符合我们需要的概率分布的规律。</p>
<h5 id="三逻辑回归模型">三、逻辑回归模型</h5>
<p>  二项逻辑回归模型本质上是一个类似下面公式的条件分布： <span class="math display">\[
P(Y = 1 | x) = \frac{1}{1 + e^{-(\omega \cdot x + b)}} \tag{1}
\]</span></p>
<p><span class="math display">\[
P(Y = 0 | x) = 1 - \frac{1}{1 + e^{-(\omega \cdot x + b)}} \tag{2}
\]</span></p>
<p>  其中，第一个式子是我们需要重点关注的。我们对第一个式子右边的分数，上下同时乘以 <span class="math inline">\(e^{\omega \cdot x + b}\)</span>，得到： <span class="math display">\[
P(Y = 1 | x) = \frac{e^{\omega \cdot x + b}}{1 + e^{\omega \cdot x + b}} \tag{3}
\]</span>   以上就是我们经常可以看到的逻辑回归的公式了。</p>
<p>  现在我们将偏置量也放进参数 <span class="math inline">\(\omega\)</span>中，所以变量<span class="math inline">\(x\)</span>的尾部会增加一个多余的维度1来和偏置量进行匹配，于是，我们有如下的表示方式： <span class="math display">\[
\omega = \begin{bmatrix} \omega_1 &amp; \omega_2 &amp; \cdots &amp; \omega_n &amp; b\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
x = \begin{bmatrix} x_1 &amp; x_2 &amp; \cdots &amp; x_n &amp; 1\end{bmatrix}
\]</span></p>
<p>  于是，原逻辑回归公式可以有以下的表达： <span class="math display">\[
P(Y = 1 | x) = \frac{e^{\omega \cdot x}}{1 + e^{\omega \cdot x}} \tag{4}
\]</span></p>
<h5 id="四损失函数">四、损失函数</h5>
<p>  很容易想到，损失函数我们仍然可以使用前面介绍的差方和的方法计算。当距离目标越近时，差方和越小，损失就会越小。事实上并不能这样进行处理。 <span class="math display">\[
J(\omega, b) = \sum_i( \frac{1}{1 + e^{-(\omega \cdot x_i)}} - y_i)^2 = \sum_i (\frac{e^{\omega \cdot x}}{1 + e^{\omega \cdot x}} - y_i) ^2\tag{4}
\]</span>   原因是如果使用差方和作为最后的损失函数，那么我们得到的最后的损失函数并不是一个简单的凹函数（或者凸函数），这个函数存在许多的局部极小值，因此很难通过梯度下降的方法收敛到全局最小值附近，这样导致的结果就是训练出来的模型并不能很好的满足我们的需要，误差较大。</p>
<p>  所以我们必须要重新定义一个满足我们条件的损失函数，或者称为目标函数。我们考虑使用极大似然估计的方法进行参数估计。</p>
<p>  对于其中的某一个样本，如果该样本的标签为1，那么我们需要极大化<span class="math inline">\(P(Y = 1|x)\)</span>，如果该样本的标签为0，那么我们需要极大化<span class="math inline">\(1 - P(Y = 1|x)\)</span>，于是对于每一个样本数据，综合来看，我们只需要极大化以下的式子即可： <span class="math display">\[
P(Y = 1|x_i)^{y_i} (1 - P(Y= 1|x_i))^{1 - y_i}
\]</span>   上面的式子看起来很吓人，其实本质很简单。于是我们的似然函数可以表示为 <span class="math display">\[
L(\omega) = \prod_i P(Y = 1|x_i)^{y_i} (1 - P(Y= 1|x_i))^{1 - y_i} \tag{5}
\]</span>   由于这里涉及指数，而且是连乘运算，计算不方便，于是我们可以用取对数的方式进行处理，这里可以这样处理的原因是上式取最大的时候，其对数也一定是取最大值，因为对数函数是一个单调函数。于是有： <span class="math display">\[
log L(\omega) = \sum_i y_i log(P(Y = 1|x_i)) + (1 - y_i) log(1 - P(Y = 1|x_i)) \tag{6}
\]</span>   现在我们可以将之前的计算结果带入到公式(6)中进行化简： <span class="math display">\[
\begin{aligned}
logL(\omega) &amp;= \sum_i y_i log(P(Y = 1|x_i)) + (1 - y_i) log(1 - P(Y = 1|x_i)) \\
&amp;= \sum_i y_i log(\frac{e^{\omega \cdot x_i}}{1 + e^{\omega \cdot x_i}}) + (1 - y_i) log(1 - \frac{e^{\omega \cdot x_i}}{1 + e^{\omega \cdot x_i}}) \\
&amp;= \sum_i y_i log(\frac{e^{\omega \cdot x_i}}{1 + e^{\omega \cdot x_i}}) + (1 - y_i) log( \frac{1}{1 + e^{\omega \cdot x_i}}) \\
&amp;= \sum_i y_i log(\frac{e^{\omega \cdot x_i}}{1 + e^{\omega \cdot x_i}}) + log( \frac{1}{1 + e^{\omega \cdot x_i}}) - y_i log(\frac{1}{1 + e^{\omega \cdot x_i}}) \\
&amp;= \sum_i y_i (log(\frac{e^{\omega \cdot x_i}}{1 + e^{\omega \cdot x_i}}) - log(\frac{1}{1 + e^{\omega \cdot x_i}})) + log(\frac{1}{1 + e^{\omega \cdot x_i}}) \\
&amp;= \sum_i y_i log(e^{\omega \cdot x_i}) - log(1 + e^{\omega \cdot x_i}) \\
&amp;= \sum_i y_i \omega \cdot x_i - log(1 + e^{\omega \cdot x_i})
\end{aligned} \tag{7}
\]</span>   于是我们需要的似然函数就变成了： <span class="math display">\[
logL(\omega) = \sum_i y_i \omega \cdot x_i - log(1 + e^{\omega \cdot x_i}) \tag{8}
\]</span>   上面的似然函数并不能直接进行最优化求解，于是我们常常利用梯度下降的方法进行逐步迭代求解，这就需要对上面的公式进行求导的操作，我们对参数<span class="math inline">\(\omega\)</span>求导如下： <span class="math display">\[
\begin{aligned}
\frac{\partial logL(\omega)}{\partial \omega} &amp;= \sum_i y_i x_i - \frac{1}{1+e^{\omega \cdot x_i}} e^{\omega \cdot x_i} x_i \\
&amp;= \sum_i y_i x_i - \frac{e^{\omega \cdot x_i} x_i}{1+e^{\omega \cdot x_i}} 
\end{aligned} \tag{9}
\]</span>   以上就是利用梯度下降算法进行逻辑回归问题的求解的（偏）导数计算公式，在每一轮的迭代过程中，我们对所有的样本进行梯度计算，最后累加梯度，然后按照计算出的梯度信息更新需要的参数。</p>
<p>  由于我们这里需要将似然函数极大化，因此和反向传播的梯度下降不同，这里使用的是类似的梯度上升的方法，于是我们有如下的迭代公式：这里的<span class="math inline">\(\alpha\)</span>指的是学习率（或者说是步长信息） <span class="math display">\[
\omega := \omega + \alpha \frac{\partial logL(\omega)}{\partial \omega} \tag{10}
\]</span></p>
<h5 id="五关于逻辑回归的似然函数">五、关于逻辑回归的似然函数</h5>
<p>  在利用不同的方式计算损失函数时，我们总是希望得到的损失函数时一个凸函数（或者凹函数），这样我们就可以保证只有一个全局的最优解，而且不存在局部极小值或者极大值，而这些条件都对我们使用梯度下降方法来求解最优化问题十分有利。如果一个函数的二阶导数总是恒大于0，我们称这个函数为凸函数，如果一个函数的二阶导数总是恒小于0，我们称这个函数为凹函数，凸函数一定存在一个全局最小值，凹函数一定存在一个全局最大值，并且不管是凹函数还是凸函数都不存在局部极小值或者局部最大值。</p>
<p>  我们以<span class="math inline">\(y = x^2\)</span>为例，经过计算我们得到它的二阶导数为<span class="math inline">\(y\prime\prime = 2\)</span>，是一个大于0的常数，因此该函数是一个凸函数，其不存在各种局部最小值或者局部最大值，只有一个全局最小值0（当然这个全局最小值也可以看作是一个某一个区域内的局部最小值）。</p>
<p>  现在我们重新审视一下我们的似然函数，之前我们已经求解出了似然函数的梯度信息（一阶导数），即： <span class="math display">\[
\frac{\partial logL(\omega)}{\partial \omega} = \sum_i y_i x_i - \frac{e^{\omega \cdot x_i} x_i}{1+e^{\omega \cdot x_i}} \tag{11}
\]</span>   我们继续对上式进行求导的操作，有： <span class="math display">\[
\begin{aligned} \frac{\partial^2 logL(\omega)}{\partial \omega^2} &amp;= \sum_i - x_i \frac{e^{\omega \cdot x_i} x_i (1 + e^{e^{\omega \cdot x_i}}) - e^{\omega \cdot x_i}(e^{\omega \cdot x_i} x_i)}{(1 + e^{\omega \cdot x_i})^2} \\
&amp;= \sum_i - x_i \frac{e^{\omega \cdot x_i} x_i}{(1 + e^{\omega \cdot x_i})^2} \\
&amp;= \sum_i - \frac{e^{\omega \cdot x_i}}{(1 + e^{\omega \cdot x_i})^2} x_i \cdot x_i 
\end{aligned} \tag{12}
\]</span>   可以发现的是，上式对于任何的一个数据集合来说都是恒小于0的，因此可以说当我们使用极大似然估计作为损失函数时，该函数是一个凹函数，有一个最大值，可以利用梯度下降（严格来说这个应该是梯度上升的方法）进行求解。</p>
<p>  通常，当我们求解出最终的参数时，可以获得一个超平面。往往我们将逻辑回归的阈值设置为0.5，将输出值高于0.5的样本标记为正样本，将输出值低于0.5的样本标记为负样本，于是，我们可以得到分类的超平面为： <span class="math display">\[
\frac{1}{1 + e^{\omega \cdot x}} = \frac{1}{2} \tag{13}
\]</span>   化简之后，我们可以得到最终的超平面的表达式为： <span class="math display">\[
\omega \cdot x = 0 \tag{14}
\]</span></p>
<h5 id="六代码">六，代码</h5>
<p>  这里的数据使用的是《机器学习实战》的数据，一共有100组数据：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">-0.017612	14.053064	0</span><br><span class="line">-1.395634	4.662541	1</span><br><span class="line">-0.752157	6.538620	0</span><br><span class="line">-1.322371	7.152853	0</span><br><span class="line">0.423363	11.054677	0</span><br><span class="line">0.406704	7.067335	1</span><br><span class="line">0.667394	12.741452	0</span><br><span class="line">-2.460150	6.866805	1</span><br><span class="line">0.569411	9.548755	0</span><br><span class="line">-0.026632	10.427743	0</span><br><span class="line">0.850433	6.920334	1</span><br><span class="line">1.347183	13.175500	0</span><br><span class="line">1.176813	3.167020	1</span><br><span class="line">-1.781871	9.097953	0</span><br><span class="line">-0.566606	5.749003	1</span><br><span class="line">0.931635	1.589505	1</span><br><span class="line">-0.024205	6.151823	1</span><br><span class="line">-0.036453	2.690988	1</span><br><span class="line">-0.196949	0.444165	1</span><br><span class="line">1.014459	5.754399	1</span><br><span class="line">1.985298	3.230619	1</span><br><span class="line">-1.693453	-0.557540	1</span><br><span class="line">-0.576525	11.778922	0</span><br><span class="line">-0.346811	-1.678730	1</span><br><span class="line">-2.124484	2.672471	1</span><br><span class="line">1.217916	9.597015	0</span><br><span class="line">-0.733928	9.098687	0</span><br><span class="line">-3.642001	-1.618087	1</span><br><span class="line">0.315985	3.523953	1</span><br><span class="line">1.416614	9.619232	0</span><br><span class="line">-0.386323	3.989286	1</span><br><span class="line">0.556921	8.294984	1</span><br><span class="line">1.224863	11.587360	0</span><br><span class="line">-1.347803	-2.406051	1</span><br><span class="line">1.196604	4.951851	1</span><br><span class="line">0.275221	9.543647	0</span><br><span class="line">0.470575	9.332488	0</span><br><span class="line">-1.889567	9.542662	0</span><br><span class="line">-1.527893	12.150579	0</span><br><span class="line">-1.185247	11.309318	0</span><br><span class="line">-0.445678	3.297303	1</span><br><span class="line">1.042222	6.105155	1</span><br><span class="line">-0.618787	10.320986	0</span><br><span class="line">1.152083	0.548467	1</span><br><span class="line">0.828534	2.676045	1</span><br><span class="line">-1.237728	10.549033	0</span><br><span class="line">-0.683565	-2.166125	1</span><br><span class="line">0.229456	5.921938	1</span><br><span class="line">-0.959885	11.555336	0</span><br><span class="line">0.492911	10.993324	0</span><br><span class="line">0.184992	8.721488	0</span><br><span class="line">-0.355715	10.325976	0</span><br><span class="line">-0.397822	8.058397	0</span><br><span class="line">0.824839	13.730343	0</span><br><span class="line">1.507278	5.027866	1</span><br><span class="line">0.099671	6.835839	1</span><br><span class="line">-0.344008	10.717485	0</span><br><span class="line">1.785928	7.718645	1</span><br><span class="line">-0.918801	11.560217	0</span><br><span class="line">-0.364009	4.747300	1</span><br><span class="line">-0.841722	4.119083	1</span><br><span class="line">0.490426	1.960539	1</span><br><span class="line">-0.007194	9.075792	0</span><br><span class="line">0.356107	12.447863	0</span><br><span class="line">0.342578	12.281162	0</span><br><span class="line">-0.810823	-1.466018	1</span><br><span class="line">2.530777	6.476801	1</span><br><span class="line">1.296683	11.607559	0</span><br><span class="line">0.475487	12.040035	0</span><br><span class="line">-0.783277	11.009725	0</span><br><span class="line">0.074798	11.023650	0</span><br><span class="line">-1.337472	0.468339	1</span><br><span class="line">-0.102781	13.763651	0</span><br><span class="line">-0.147324	2.874846	1</span><br><span class="line">0.518389	9.887035	0</span><br><span class="line">1.015399	7.571882	0</span><br><span class="line">-1.658086	-0.027255	1</span><br><span class="line">1.319944	2.171228	1</span><br><span class="line">2.056216	5.019981	1</span><br><span class="line">-0.851633	4.375691	1</span><br><span class="line">-1.510047	6.061992	0</span><br><span class="line">-1.076637	-3.181888	1</span><br><span class="line">1.821096	10.283990	0</span><br><span class="line">3.010150	8.401766	1</span><br><span class="line">-1.099458	1.688274	1</span><br><span class="line">-0.834872	-1.733869	1</span><br><span class="line">-0.846637	3.849075	1</span><br><span class="line">1.400102	12.628781	0</span><br><span class="line">1.752842	5.468166	1</span><br><span class="line">0.078557	0.059736	1</span><br><span class="line">0.089392	-0.715300	1</span><br><span class="line">1.825662	12.693808	0</span><br><span class="line">0.197445	9.744638	0</span><br><span class="line">0.126117	0.922311	1</span><br><span class="line">-0.679797	1.220530	1</span><br><span class="line">0.677983	2.556666	1</span><br><span class="line">0.761349	10.693862	0</span><br><span class="line">-2.168791	0.143632	1</span><br><span class="line">1.388610	9.341997	0</span><br><span class="line">0.317029	14.739025	0</span><br></pre></td></tr></table></figure>
<p>  前两列为数据，最后一列为对应数据的标签。</p>
<p>  代码如下：</p>
<figure class="highlight python hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt</span><br><span class="line"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_file</span><span class="hljs-params">()</span>:</span></span><br><span class="line">    positive = []</span><br><span class="line">    negative = []</span><br><span class="line"></span><br><span class="line">    f = open(<span class="hljs-string">"testSet.txt"</span>, <span class="hljs-string">"r"</span>)</span><br><span class="line">    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f:</span><br><span class="line">        l = line.strip()</span><br><span class="line">        l = l.split(<span class="hljs-string">"\t"</span>)</span><br><span class="line">        l = [float(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> l]</span><br><span class="line">        <span class="hljs-keyword">if</span> l[<span class="hljs-number">-1</span>] == <span class="hljs-number">1.0</span>:</span><br><span class="line">            positive.append([l[<span class="hljs-number">0</span>], l[<span class="hljs-number">1</span>], <span class="hljs-number">1</span>])</span><br><span class="line">        <span class="hljs-keyword">else</span>:</span><br><span class="line">            negative.append([l[<span class="hljs-number">0</span>], l[<span class="hljs-number">1</span>], <span class="hljs-number">1</span>])</span><br><span class="line">    positive = np.array(positive, dtype=np.float)</span><br><span class="line">    negative = np.array(negative, dtype=np.float)</span><br><span class="line">    <span class="hljs-keyword">return</span> positive, negative</span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cost</span><span class="hljs-params">(positive, negative, w)</span>:</span></span><br><span class="line">    c = <span class="hljs-number">0</span></span><br><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> positive:</span><br><span class="line">        c += <span class="hljs-number">1.0</span> * np.sum(np.multiply(w, i)) - np.log(<span class="hljs-number">1</span> + np.exp(np.sum(np.multiply(w, i))))</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> negative:</span><br><span class="line">        c += <span class="hljs-number">0.0</span> * np.sum(np.multiply(w, i)) - np.log(<span class="hljs-number">1</span> + np.exp(np.sum(np.multiply(w, i))))</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>:</span></span><br><span class="line">    positive, negative = read_file()</span><br><span class="line">    w = np.array([<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>])</span><br><span class="line">    w_copy = w.copy()</span><br><span class="line">    alpha = <span class="hljs-number">0.001</span></span><br><span class="line">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">2000</span>):</span><br><span class="line">        print(cost(positive, negative, w))</span><br><span class="line">        gradient = np.array([<span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>, <span class="hljs-number">0.</span>])</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> positive:</span><br><span class="line">            gradient += <span class="hljs-number">1.0</span> * i - (np.exp(np.sum(np.multiply(w, i))) * i) / (<span class="hljs-number">1</span> + np.exp(np.sum(np.multiply(w, i))))</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> negative:</span><br><span class="line">            gradient += <span class="hljs-number">0.0</span> * i - (np.exp(np.sum(np.multiply(w, i))) * i) / (<span class="hljs-number">1</span> + np.exp(np.sum(np.multiply(w, i))))</span><br><span class="line"></span><br><span class="line">        w = w + alpha * gradient</span><br><span class="line">    <span class="hljs-keyword">return</span> positive, negative, w, w_copy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:</span><br><span class="line">    positive, negative, w, w_origin = loop()</span><br><span class="line">    plt.scatter(positive[:, <span class="hljs-number">0</span>], positive[:, <span class="hljs-number">1</span>], c=<span class="hljs-string">"red"</span>)</span><br><span class="line">    plt.scatter(negative[:, <span class="hljs-number">0</span>], negative[:, <span class="hljs-number">1</span>], c=<span class="hljs-string">'blue'</span>)</span><br><span class="line">    xs = np.linspace(<span class="hljs-number">-4</span>, <span class="hljs-number">3.5</span>, <span class="hljs-number">300</span>)</span><br><span class="line">    ys1 = (w[<span class="hljs-number">0</span>] * xs + w[<span class="hljs-number">2</span>]) / (- w[<span class="hljs-number">1</span>])</span><br><span class="line">    ys2 = (w_origin[<span class="hljs-number">0</span>] * xs + w_origin[<span class="hljs-number">2</span>]) / (- w_origin[<span class="hljs-number">1</span>])</span><br><span class="line"></span><br><span class="line">    plt.plot(xs, ys1, c=<span class="hljs-string">"green"</span>)</span><br><span class="line">    plt.plot(xs, ys2, c=<span class="hljs-string">"yellow"</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>
<p>  代码运行结果如下，其中黄色直线表示的是初始的分隔超平面，绿色的直线表示为分类超平面，可以看出，样本数据可以较好地被分隔开，第二幅图表示的是梯度上升的情况，可以看到，算法可以较好地收敛于全局最优解附近： <img src="/2019/05/10/Note3-Logic-Regression/Figure_1.png"> <img src="/2019/05/10/Note3-Logic-Regression/Figure_2.png"></p>

        </div>
        
            <ul class="post-copyright">
            <li><strong>本文标题：</strong><a href="http://huaxuan0720.github.io/2019/05/10/Note3-Logic-Regression/">逻辑回归算法</a></li>
            <li><strong>本文作者：</strong><a href="http://huaxuan0720.github.io">华轩</a></li>
            <li><strong>本文链接：</strong><a href="http://huaxuan0720.github.io/2019/05/10/Note3-Logic-Regression/">http://huaxuan0720.github.io/2019/05/10/Note3-Logic-Regression/</a></li>
            <li><strong>发布时间：</strong>2019-05-10</li>
            <li><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！
            </li>
            </ul>
        
        
        <hr style="height:1px;margin:1rem 0">
        <div class="level is-size-7 is-uppercase">
            <div class="level-start">
                <div class="level-item">
                    <i class="fas fa-tags has-text-grey"></i>&nbsp;
                    <a class="has-link-grey -link" href="/tags/机器学习/">机器学习</a>,&nbsp;<a class="has-link-grey -link" href="/tags/逻辑回归/">逻辑回归</a>
                </div>
            </div>
        </div>
        
        
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="menu-label has-text-centered">Suka dengan artikel ini? Bantu penulis dengan donasi melalui</h3>
        <div class="buttons is-centered">
            
                
<a class="button is-info donate">
    <span class="icon is-small">
        <i class="fab fa-alipay"></i>
    </span>
    <span>Alipay</span>
    <div class="qrcode"><img src="/images/alipay.jpg" alt="Alipay"></div>
</a>

                
                
<a class="button is-success donate">
    <span class="icon is-small">
        <i class="fab fa-weixin"></i>
    </span>
    <span>Wechat</span>
    <div class="qrcode"><img src="/images/wechat.jpg" alt="Wechat"></div>
</a>

                
        </div>
    </div>
</div>



<div class="card card-transparent">
    <div class="level post-navigation is-flex-wrap is-mobile">
        
        <div class="level-start">
            <a class="level level-item has-link-grey  article-nav-prev" href="/2019/05/12/Note5-PCA/">
                <i class="level-item fas fa-chevron-left"></i>
                <span class="level-item">主成分分析PCA</span>
            </a>
        </div>
        
        
        <div class="level-end">
            <a class="level level-item has-link-grey  article-nav-next" href="/2019/05/10/Note4-SVD/">
                <span class="level-item">奇异值分解SVD</span>
                <i class="level-item fas fa-chevron-right"></i>
            </a>
        </div>
        
    </div>
</div>



<div class="card">
    <div class="card-content">
        <h3 class="title is-5 has-text-weight-normal">Commentaires</h3>
        
<div id="valine-thread" class="content"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
    new Valine({
        el: '#valine-thread' ,
        notify: true,
        verify: false,
        app_id: 'iccwxYBr9y70NgcI4taslyB9-gzGzoHsz',
        app_key: 'ksGgGN0AeLXQQ1HfOy0mCrM0',
        placeholder: 'xxxxxxxx'
    });
</script>

    </div>
</div>

</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level" style="margin-bottom:1rem">
            <div class="level-item has-text-centered">
                <div>
                    
                        <img class="image is-96x96 has-mb-6" src="/images/icon.jpg" alt="华轩">
                    
                    
                    <p class="is-size-4 is-block">
                        华轩
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        A Student
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Hangzhou Zhejiang, China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level menu-list is-mobile" style="margin-bottom:1rem">
            <div class="level-item has-text-centered is-marginless">
                <a href="/archives/">
                    <p class="heading">
                        Articles
                    </p>
                    <p class="title has-text-weight-normal">
                        25
                    </p>
                </a>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <a href="/categories/">
                    <p class="heading">
                        Catégories
                    </p>
                    <p class="title has-text-weight-normal">
                        3
                    </p>
                </a>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <a href="/tags/">
                    <p class="heading">
                        Tags
                    </p>
                    <p class="title has-text-weight-normal">
                        21
                    </p>
                </a>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/huaxuan0720" target="_blank">
                <i class="fab fa-github"></i>&nbsp;&nbsp;SUIVRE</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Github" href="https://github.com/huaxuan0720">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Facebook" href="/">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Twitter" href="/">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>

    
        
<div class="card widget column-left is-sticky" id="toc">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Catalogue
            </h3>
            <ul class="menu-list"><li>
        <a class="is-flex" href="#一逻辑斯蒂回归">
        <span class="has-mr-6">1</span>
        <span>一、逻辑斯蒂回归</span>
        </a></li><li>
        <a class="is-flex" href="#二sigmoid函数">
        <span class="has-mr-6">2</span>
        <span>二、sigmoid函数</span>
        </a></li><li>
        <a class="is-flex" href="#三逻辑回归模型">
        <span class="has-mr-6">3</span>
        <span>三、逻辑回归模型</span>
        </a></li><li>
        <a class="is-flex" href="#四损失函数">
        <span class="has-mr-6">4</span>
        <span>四、损失函数</span>
        </a></li><li>
        <a class="is-flex" href="#五关于逻辑回归的似然函数">
        <span class="has-mr-6">5</span>
        <span>五、关于逻辑回归的似然函数</span>
        </a></li><li>
        <a class="is-flex" href="#六代码">
        <span class="has-mr-6">6</span>
        <span>六，代码</span>
        </a></li></ul>
        </div>
    </div>
</div>


    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
        </div>
    
</div>

                
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/favicon.svg" alt="逻辑回归算法" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 华轩&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                Visited by <span id="busuanzi_value_site_uv">0</span> users
                </span>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                        
                        <i class="fab fa-creative-commons"></i>&nbsp;<i class="fab fa-creative-commons-by"></i>&nbsp;<i class="fab fa-creative-commons-nc"></i>&nbsp;<i class="fab fa-creative-commons-sa"></i>&nbsp;
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Xuan Hua&#39;s GitHub" href="https://www.github.com/huaxuan0720">
                        
                        <i class="fab fa-github"></i>&nbsp;
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Kembali ke atas" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Articles',
                PAGES: 'Pages',
                CATEGORIES: 'Catégories',
                TAGS: 'Tags',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>